import{a as xe}from"./chunk-2RN3PGED.js";import"./chunk-NJXNSQTG.js";import{a as ke}from"./chunk-SDGOOU6G.js";import{a as H,b as F,d as be,e as Pe}from"./chunk-4FBR3SYM.js";import{b as Ce}from"./chunk-YD2NOG34.js";import{a as ee}from"./chunk-MT4QVEUY.js";import{a as ve}from"./chunk-ERUAW4UO.js";import"./chunk-MFHZ6JZ7.js";import"./chunk-T47JS64O.js";import"./chunk-RDOH2E2X.js";import"./chunk-XIUDFJWJ.js";import"./chunk-WYCWMXPA.js";import{g as w,i as W,j as q,p as T}from"./chunk-I77QJBBK.js";import{a as Ae,b as Se,c as Ee,d as Le,e as Re,f as $e,l as Ve,m as je,o as Be}from"./chunk-5D3ZBKU5.js";import"./chunk-MTK7EKDI.js";import"./chunk-IQKXYVAO.js";import{a as L,b as Me}from"./chunk-XOG3MR4O.js";import{a as D}from"./chunk-FGIWLLTD.js";import"./chunk-THCNWKDC.js";import"./chunk-SOKUPTDF.js";import"./chunk-MVGT6HIX.js";import{a as ye,c as Oe,e as we,f as Te,g as Fe,i as De}from"./chunk-EKMWFXOB.js";import"./chunk-WLWXH53B.js";import"./chunk-ZA3WZWW5.js";import{a as ge,y as E}from"./chunk-57VKPFDS.js";import{Ea as he,Ga as G}from"./chunk-XMIP7OAF.js";import"./chunk-I7VYXJU2.js";import{Ac as de,C as $,Ca as ie,Fc as I,G as V,Gb as K,Gc as N,Hc as z,Ib as re,Ic as ue,Kc as U,M as j,Mc as b,Nc as P,Ob as _,Pb as X,Qb as le,Sb as me,Ub as c,Vb as ce,Zb as M,_b as Y,a as k,ac as v,b as A,bc as y,ca as B,cc as s,dc as m,ec as d,hb as ae,ic as O,ie as _e,je as fe,k as ne,la as r,lc as C,mb as l,me as Q,nc as p,q as S,u as R,ua as f,va as g,vb as h,vc as se,wc as pe,xc as Z,y as oe,yc as x}from"./chunk-FZSJMIDG.js";var Ie=[];var Ne=(()=>{class e{router=r(W);destroyRef=r(ie);authFacade=r(D);layoutFacade=r(Ce);constructor(){this.authFacade.auth$.pipe(E()).subscribe(t=>{t&&(this.layoutFacade.loadNavLinks(t.roles),this.waitingForLogout())}),this.authFacade.load()}waitingForLogout(){this.authFacade.auth$.pipe(E(this.destroyRef)).subscribe(t=>{t===null&&(this.layoutFacade.resetNavLinks(),this.router.navigateByUrl("/conta/autenticacao"))})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=h({type:e,selectors:[["devmx-album-feature-shell"]],decls:1,vars:0,template:function(n,o){n&1&&d(0,"devmx-layout")},dependencies:[T,xe],styles:["[_nghost-%COMP%]{flex:1;display:flex;flex-direction:column}"],changeDetection:0})}return e})();var ze=e=>be(r(H),e.params);var Ue=e=>Pe(r(F),e.params);var He=e=>["/","sobre",e];function Je(e,a){if(e&1&&(s(0,"div",18),d(1,"devmx-icon",19),m()),e&2){let t=a.$implicit;ce("left",t.x,"%")("top",t.y,"%"),c("matTooltip",t.user.displayName)}}function Ke(e,a){e&1&&x(0,"Ningu\xE9m foi marcado ainda")}function Xe(e,a){e&1&&x(0,"Est\xE1 na foto: ")}function Ye(e,a){e&1&&x(0,"Est\xE3o na foto: ")}function Ze(e,a){e&1&&x(0,",")}function et(e,a){e&1&&(s(0,"span"),x(1,"e"),m())}function tt(e,a){if(e&1&&(_(0,Ze,1,0)(1,et,2,0,"span"),s(2,"a",20),x(3),m()),e&2){let t=a.$implicit,n=a.$index,o=a.$count;M(n!==0&&n!==o-1?0:n===o-1?1:-1),l(2),c("routerLink",U(3,He,t.user.name)),l(),de(" ",t.user.displayName," ")}}function nt(e,a){if(e&1){let t=O();I(0),b(1,"async"),s(2,"mat-card")(3,"mat-card-header",3)(4,"button",4),d(5,"devmx-icon",5),m(),s(6,"mat-menu",6,0)(8,"button",7),C("click",function(){let o=f(t),i=z(0),u=p();return g(u.removeMyTag(o,i))}),x(9," Remover minha tag "),m()()(),s(10,"figure")(11,"div",8)(12,"img",9,1),C("click",function(){let o=f(t),i=p();return g(i.toggleTags(o))}),m(),v(14,Je,2,5,"div",10,Y),m()(),s(16,"mat-card-content",11)(17,"dl")(18,"dt",12),_(19,Ke,1,0,"ng-template",13)(20,Xe,1,0,"ng-template",14)(21,Ye,1,0,"ng-template",15),m(),s(22,"dd"),v(23,tt,4,5,null,null,Y),m()()(),s(25,"mat-card-actions")(26,"button",16,2),C("click",function(){f(t);let o=Z(27),i=p();return g(i.share(o))}),d(28,"devmx-icon",17),m()()()}if(e&2){let t,n=a,o=Z(7),i=p(),u=N(P(1,8,i.authFacade.auth$));l(4),c("matMenuTriggerFor",o),l(4),c("disabled",!i.hasTagWithMe(n,u)),l(4),c("src",n.data,ae)("alt",n.caption),l(2),y(n.tags),l(4),c("ngPlural",(t=n.tags==null?null:n.tags.length)!==null&&t!==void 0?t:0),l(5),y(n.tags),l(3),c("ariaLabel",i.shareLabel())("matTooltip",i.shareLabel())("cdkCopyToClipboard","https://devparana.mx/#/albuns/fotos/"+n.id)}}var Qe=(()=>{class e{route=r(w);authFacade=r(D);photoFacade=r(F);tooltips=re(L);#e=new ne(null);photo$=this.#e.asObservable();resolved$=this.route.data.pipe(V(t=>"photo"in t),R(t=>t.photo));keepEquals=K(!0);shareLabel=K("Compartilhar");constructor(){this.resolved$.subscribe(t=>{t&&this.#e.next(t)})}share(t){let n=o=>B(()=>this.shareLabel.set(o));oe($(500),S("").pipe(n("Link copiado")),S("").pipe(B(()=>t.show())),$(2e3),S("").pipe(B(()=>t.hide())),$(1e3),S("").pipe(n("Compartilhar"))).subscribe()}getUserFromTags(t=[]){return t.map(n=>n.user.displayName)}toggleTags(t){if(!t.tags?.length)return;let n=this.tooltips();for(let o=0;o<n.length-1;o++)n[o].toggle()}hasTagWithMe(t,n){return t.tags?.some(o=>o.user.id===n.id)}removeMyTag(t,n){let o=t.tags?.filter(i=>i.user.id!==n.id)??[];this.photoFacade.updateTags(A(k({},t),{tags:o})).pipe(j(1)).subscribe(i=>{this.#e.next(i)})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=h({type:e,selectors:[["devmx-photo-details"]],viewQuery:function(n,o){n&1&&se(o.tooltips,L,5),n&2&&pe()},decls:2,vars:3,consts:[["menu","matMenu"],["imageRef",""],["refTooltip","matTooltip"],[1,"photo-header"],["mat-icon-button","","aria-label","Op\xE7\xF5es de controle",1,"more-menu",3,"matMenuTriggerFor"],["name","menu/burguer-menu"],["xPosition","before"],["mat-menu-item","",3,"click","disabled"],[1,"photo-viewer"],["mat-card-image","",3,"click","src","alt"],["matTooltipTouchGestures","off","matTooltipPosition","after",1,"user-tag",3,"left","top","matTooltip"],[1,"photo-content"],[3,"ngPlural"],["ngPluralCase","=0"],["ngPluralCase","=1"],["ngPluralCase","other"],["mat-icon-button","","matTooltipPosition","after",3,"click","ariaLabel","matTooltip","cdkCopyToClipboard"],["name","share"],["matTooltipTouchGestures","off","matTooltipPosition","after",1,"user-tag",3,"matTooltip"],["name","tag"],[3,"routerLink"]],template:function(n,o){if(n&1&&(_(0,nt,29,11,"mat-card"),b(1,"async")),n&2){let i;M((i=P(1,1,o.photo$))?0:-1,i)}},dependencies:[De,ye,we,Oe,Te,Fe,Me,L,G,he,$e,Le,Ee,Re,Se,Ae,ge,q,_e,fe,Q],styles:["[_nghost-%COMP%]{flex:1;padding:1em;display:flex;flex-direction:column;align-items:center;justify-content:center}[_nghost-%COMP%]   .photo-header[_ngcontent-%COMP%]{display:flex;position:relative;height:40px}[_nghost-%COMP%]   .photo-header[_ngcontent-%COMP%]   .more-menu[_ngcontent-%COMP%]{position:absolute;right:8px;top:8px}[_nghost-%COMP%]   figure[_ngcontent-%COMP%]{margin:0;width:100%;max-height:100%;position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;overflow:hidden;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   figure[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;max-width:100%;cursor:context-menu;object-fit:pointer;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   figure[_ngcontent-%COMP%]   .photo-viewer[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   figure[_ngcontent-%COMP%]   .user-tag[_ngcontent-%COMP%]{position:absolute;transform:translate(-50%,-50%);display:flex;align-items:flex-end;justify-content:flex-end;transition:opacity .25s ease-in-out;color:#f9e000;width:64px;height:64px}[_nghost-%COMP%]   .photo-content[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]{display:flex;gap:.2em}[_nghost-%COMP%]   .photo-content[_ngcontent-%COMP%]   dd[_ngcontent-%COMP%]{margin:0;display:flex;gap:.1em}[_nghost-%COMP%]   .photo-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-flex;margin-left:.2em}[_nghost-%COMP%]   .photo-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-flex;margin-left:.2em}"],changeDetection:0})}return e})();var ot=(e,a)=>a.id,it=()=>[ve,ee,import("./chunk-DPOW4OC5.js").then(e=>e.AsyncPipe)],at=()=>[import("./chunk-4IDXV4PY.js").then(e=>e.AlbumCardComponent),q],rt=e=>[".",e];function lt(e,a){if(e&1&&(s(0,"a",3),d(1,"devmx-album-card",4),m()),e&2){let t=p().$implicit;c("routerLink",U(2,rt,t.id)),l(),c("data",t)}}function mt(e,a){e&1&&d(0,"devmx-skeleton",5),e&2&&c("rows",3)}function ct(e,a){e&1&&(_(0,lt,2,4)(1,mt,1,1),X(2,0,at,null,1),me(0,-1))}function st(e,a){if(e&1){let t=O();s(0,"div",0),v(1,ct,4,0,null,null,ot),m(),d(3,"div",1),s(4,"footer")(5,"devmx-paginator",2),C("pageChange",function(o){f(t);let i=p(2);return g(i.onPageChange(o))}),m()()}if(e&2){let t=a;l(),y(t.data),l(4),c("size",10)("items",t.items)}}function pt(e,a){if(e&1&&(_(0,st,6,2),b(1,"async")),e&2){let t,n=p();M((t=P(1,1,n.albumFacade.response$))?0:-1,t)}}function dt(e,a){e&1&&(s(0,"div",0),d(1,"devmx-skeleton",5)(2,"devmx-skeleton",5)(3,"devmx-skeleton",5),m()),e&2&&(l(),c("rows",3),l(),c("rows",2),l(),c("rows",3))}var We=(()=>{class e{albumFacade=r(H);router=r(W);route=r(w);constructor(){this.route.queryParams.pipe(E()).subscribe(this.onQueryParams)}onQueryParams=t=>{let{page:n=0,size:o=10}=t,{title:i=""}=t,u={title:i};this.albumFacade.setParams({page:n,size:o,filter:u}),this.albumFacade.load()};onPageChange(t){this.router.navigate([],{queryParams:t})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=h({type:e,selectors:[["devmx-admin-albums"]],decls:5,vars:0,consts:[[1,"albums-container"],[1,"spacer"],[3,"pageChange","size","items"],[3,"routerLink"],[3,"data"],[3,"rows"]],template:function(n,o){n&1&&(d(0,"header"),_(1,pt,2,3)(2,dt,4,3),X(3,1,it,null,2),le(500))},dependencies:[ee,T],styles:["[_nghost-%COMP%]{flex:1;display:flex;flex-direction:column}[_nghost-%COMP%]   header[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:space-between;padding:.4em .8em}[_nghost-%COMP%]   .albums-container[_ngcontent-%COMP%]{gap:1em;padding:1em;display:grid;grid-auto-flow:dense;grid-template-columns:repeat(4,1fr)}@media (max-width: 1918px){[_nghost-%COMP%]   .albums-container[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (max-width: 1278px){[_nghost-%COMP%]   .albums-container[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 767px){[_nghost-%COMP%]   .albums-container[_ngcontent-%COMP%]{grid-template-columns:repeat(1,1fr)}}[_nghost-%COMP%]   .albums-container[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{flex:1;display:flex}[_nghost-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"],changeDetection:0})}return e})();var ut=(e,a)=>a.id;function _t(e,a){if(e&1){let t=O();s(0,"devmx-photo",2),C("click",function(){let o=f(t).$implicit,i=p(),u=z(0),J=p();return g(J.open(o,u,i.id))}),m()}if(e&2){let t=a.$implicit;c("photo",t)}}function ft(e,a){if(e&1&&(I(0),b(1,"async"),s(2,"div",0),v(3,_t,1,1,"devmx-photo",1,ut),m()),e&2){let t=p();N(P(1,0,t.authFacade.auth$)),l(3),y(a.photos)}}var qe=(()=>{class e{route=r(w);authFacade=r(D);photoFacade=r(F);photoViewer=r(Ve);album$=this.route.data.pipe(V(t=>"album"in t),R(t=>t.album));open(t,n,o){let i=this.photoViewer.open({photo:t,auth:n});i.updated$.subscribe(u=>{let J=u.tags??[];this.photoFacade.updateTags(A(k({},u),{tags:J,album:o})).pipe(j(1)).subscribe(Ge=>{i.updated(Ge)})})}updateTags=t=>n=>{if(n&&n.tags){let o=n.tags??[];this.photoFacade.updateTags(A(k({},n),{tags:o,album:t}))}};static \u0275fac=function(n){return new(n||e)};static \u0275cmp=h({type:e,selectors:[["devmx-album"]],features:[ue([je()])],decls:2,vars:3,consts:[[1,"grid"],[1,"photo",3,"photo"],[1,"photo",3,"click","photo"]],template:function(n,o){if(n&1&&(_(0,ft,5,3,"div",0),b(1,"async")),n&2){let i;M((i=P(1,1,o.album$))?0:-1,i)}},dependencies:[T,G,Be,Q],styles:["[_nghost-%COMP%]{flex:1;padding:1em;display:flex;flex-direction:column}[_nghost-%COMP%]   .grid[_ngcontent-%COMP%]{gap:1em;display:grid;grid-auto-flow:dense;grid-template-columns:repeat(4,1fr)}@media (max-width: 1918px){[_nghost-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (max-width: 1278px){[_nghost-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 767px){[_nghost-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:repeat(1,1fr)}}[_nghost-%COMP%]   .photo[_ngcontent-%COMP%]{margin:0;box-sizing:border-box;border-radius:.4em;position:relative;overflow:hidden;background-color:#0000000a;transition:width .3s ease-in-out}"],changeDetection:0})}return e})();var Vn=[{path:"",data:{breadcrumb:"Albuns"},canActivate:[ke("member")],providers:Ie,component:Ne,children:[{path:"administracao",loadChildren:()=>import("./chunk-ZIJ46EP5.js").then(e=>e.albumFeatureAdminRoutes)},{path:"fotos/:id",data:{breadcrumb:e=>"Foto do album "+e.photo.album.title},title:"Foto",resolve:{photo:Ue},component:Qe},{path:":id",data:{breadcrumb:e=>e.album.title},title:"Album de fotos",resolve:{album:ze},component:qe},{path:"",data:{breadcrumb:"Albuns"},title:"Albuns",component:We}]}];export{Ne as AlbumFeatureShellComponent,Vn as albumFeatureShellRoutes};
