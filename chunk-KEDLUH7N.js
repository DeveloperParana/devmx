import{a as L,b as B,c as F,d as w,f as s,h as z,n as V}from"./chunk-JS3QJ7O4.js";import{i as T,m as E}from"./chunk-HSPBE7XI.js";import{F as u,L as a,O as $,_ as H,a as j,b as q,c as k,t as I}from"./chunk-TEKHUYWQ.js";var n=class{};var o=class extends L{};var d=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.createUser(e)}};var h=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.delete(e)}};var l=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.findOne(e)}};var U=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.findOneByName(e)}};var x=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.find(e)}};var m=class{authenticationService;constructor(e){this.authenticationService=e}execute(){return this.authenticationService.load()}};var f=class{authenticationService;constructor(e){this.authenticationService=e}execute({name:e}){return this.authenticationService.sendUserCode(e)}};var v=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.updatePassword(e)}};var C=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.updatePhoto(e)}};var S=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.updateProfile(e)}};var P=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.updateRoles(e)}};var g=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.updateSocial(e)}};var b=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.update(e.id,e)}};var y=class{authenticationService;constructor(e){this.authenticationService=e}execute(e){return this.authenticationService.validateUserCode(e).pipe(H(({accessToken:t})=>(localStorage.setItem("accessToken",t),this.authenticationService.load())))}};var W=T({auth:null,loading:!1,message:null,sended:!1}),N=class extends E{createUserUseCase;sendUserCodeUseCase;validateUserCodeUseCase;loadAuthenticationUseCase;auth$=this.select(e=>e.auth);message$=this.select(e=>e.message);loading$=this.select(e=>e.loading);connected$=this.select(()=>!!this.accessToken);get accessToken(){return localStorage.getItem("accessToken")}constructor(e,t,i,c){super(W),this.createUserUseCase=e,this.sendUserCodeUseCase=t,this.validateUserCodeUseCase=i,this.loadAuthenticationUseCase=c}load(){this.loadAuthenticationUseCase.execute().pipe(a(1)).subscribe(t=>this.setState({auth:t}))}sendUserCode(e){this.setState({loading:!0}),this.sendUserCodeUseCase.execute(e).pipe(a(1)).subscribe(({message:i})=>{this.setState({sended:!0,loading:!1,message:i})})}validateUserCode(e){this.setState({loading:!0}),this.validateUserCodeUseCase.execute(e).pipe(a(1)).subscribe(()=>this.setState({loading:!1}))}createUser(e){this.setState({loading:!0}),this.createUserUseCase.execute(e).pipe(a(1)).subscribe()}signOut(){this.setState(W),localStorage.removeItem("accessToken")}};function M(){return w(N,[d,f,y,m])}function G(r){return{"@context":"https://schema.org","@type":"Person",name:r.displayName,email:`mailto:${r.contact.email}`,url:`https://devparana.mx/#/sobre/${r.name}`}}var O=class extends V{findUsersUseCase;findUserByIDUseCase;updateProfileUseCase;updateUserUseCase;updatePhotoUseCase;updatePasswordUseCase;updateSocialUseCase;updateRolesUseCase;deleteUserUseCase;findUserByNameUseCase;profile$=this.select(e=>{if(e.selected){let{profile:t,id:i}=e.selected;return q(j({},t),{id:i})}return null});social$=this.select(e=>{if(e.selected){let{social:t,id:i}=e.selected;return{social:t,id:i}}return null});schema$=this.selected$.pipe(u(e=>!!e),I(e=>G(e)));constructor(e,t,i,c,p,A,_,ee,te,re){super({response:{data:[],items:0,pages:0},params:{page:0,size:10,filter:{name:""}},selected:null}),this.findUsersUseCase=e,this.findUserByIDUseCase=t,this.updateProfileUseCase=i,this.updateUserUseCase=c,this.updatePhotoUseCase=p,this.updatePasswordUseCase=A,this.updateSocialUseCase=_,this.updateRolesUseCase=ee,this.deleteUserUseCase=te,this.findUserByNameUseCase=re}load(){this.onLoad(this.findUsersUseCase.execute(this.state.params))}loadOne(e){this.onLoadOne(this.findUserByIDUseCase.execute(e))}loadOneByName(e){this.onLoadOne(this.findUserByNameUseCase.execute(e))}update(e){this.updateUserUseCase.execute(e).pipe(a(1)).subscribe()}updateProfile(e){this.updateProfileUseCase.execute(e).pipe(a(1)).subscribe()}updatePhoto(e){this.updatePhotoUseCase.execute(e).pipe(a(1)).subscribe()}updatePassword(e){this.onUpdate(this.updatePasswordUseCase.execute(e))}updateSocial(e){this.updateSocialUseCase.execute(e).pipe(a(1)).subscribe()}updateRoles(e){this.onUpdate(this.updateRolesUseCase.execute(e))}delete(e){this.onDelete(this.deleteUserUseCase.execute(e))}};function J(){return w(O,[x,l,S,b,C,v,g,P,h,U])}function K(){return[M(),J()]}var R=class{http;env;endpoint;get url(){return`${this.env.api.url}/${this.endpoint}`}constructor(e,t,i){this.http=e,this.env=t,this.endpoint=i}load(){return this.http.get(this.url)}createUser(e){let t=[this.url,"create-user"];return this.http.post(t.join("/"),e)}sendUserCode(e){return this.http.post(this.url,{name:e})}validateUserCode(e){let t=[this.url,"validate"];return this.http.post(t.join("/"),e)}};function Q(){return{provide:n,useFactory(r,e){return new R(r,e,"authentication")},deps:[F,B]}}var D=class extends z{findOneByName(e){let t=[this.url,"about",e];return this.http.get(t.join("/"))}updatePassword(e){let t=[this.url,e.id,"password"];return this.http.patch(t.join("/"),e)}updateProfile(e){let t=[this.url,e.id,"profile"];return this.http.patch(t.join("/"),e)}updatePhoto(i){var c=i,{id:e}=c,t=k(c,["id"]);let p=new FormData;p.append("photo",t.photo),p.append("gender",t.gender??""),p.append("minibio",t.minibio??""),p.append("birthday",t.birthday??"");let A=[this.url,e,"photo"];return this.http.post(A.join("/"),p)}updateSocial(e){let t=[this.url,e.id,"social"];return this.http.patch(t.join("/"),e)}updateRoles(e){let t=[this.url,e.id,"roles"];return this.http.patch(t.join("/"),e)}};function X(){return{provide:o,useFactory(r,e){return new D(r,e,"users")},deps:[F,B]}}function Y(){return[Q(),X()]}function se(){return s(d,[n])}function oe(){return s(h,[o])}function ie(){return s(l,[o])}function ae(){return s(U,[o])}function ne(){return s(x,[o])}function pe(){return s(m,[n])}function ce(){return s(f,[n])}function ue(){return s(v,[o])}function de(){return s(S,[o])}function he(){return s(b,[o])}function le(){return s(C,[o])}function Ue(){return s(g,[o])}function xe(){return s(P,[o])}function me(){return s(y,[n])}function Z(){return[se(),oe(),ie(),ae(),ne(),pe(),ce(),ue(),le(),de(),he(),Ue(),xe(),me()]}function Mt(){return[...Y(),...Z(),...K()]}var Kt=(r,e)=>(r.loadOneByName(e.name),r.selected$.pipe($(),u(t=>!!t)));var Yt=(r,e)=>(r.loadOneByName(e.name),r.schema$.pipe($(),u(t=>!!t)));export{N as a,O as b,Mt as c,Kt as d,Yt as e};
