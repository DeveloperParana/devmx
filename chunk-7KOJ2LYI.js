import{a as L,b as B,c as F,d as w,f as s,h as W,n as z}from"./chunk-OCN2RHRZ.js";import{i as T,m as E}from"./chunk-CVM2AHGP.js";import{F as n,L as a,O as d,_ as H,a as k,b as q,c as I,t as N}from"./chunk-TEKHUYWQ.js";var p=class{};var o=class extends L{};var h=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.createUser(e)}};var l=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.delete(e)}};var U=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.findOne(e)}};var x=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.findOneByName(e)}};var m=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.find(e)}};var f=class{authenticationService;constructor(e){this.authenticationService=e}execute(){return this.authenticationService.load()}};var v=class{authenticationService;constructor(e){this.authenticationService=e}execute({name:e}){return this.authenticationService.sendUserCode(e)}};var C=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.updatePassword(e)}};var S=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.updatePhoto(e)}};var g=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.updateProfile(e)}};var P=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.updateRoles(e)}};var b=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.updateSocial(e)}};var y=class{userService;constructor(e){this.userService=e}execute(e){return this.userService.update(e.id,e)}};var $=class{authenticationService;constructor(e){this.authenticationService=e}execute(e){return this.authenticationService.validateUserCode(e).pipe(H(({accessToken:t})=>(localStorage.setItem("accessToken",t),this.authenticationService.load())))}};var V=T({auth:null,loading:!1,message:null,sended:!1}),O=class extends E{createUserUseCase;sendUserCodeUseCase;validateUserCodeUseCase;loadAuthenticationUseCase;auth$=this.select(e=>e.auth);message$=this.select(e=>e.message);loading$=this.select(e=>e.loading);connected$=this.select(()=>!!this.accessToken);get accessToken(){return localStorage.getItem("accessToken")}constructor(e,t,i,c){super(V),this.createUserUseCase=e,this.sendUserCodeUseCase=t,this.validateUserCodeUseCase=i,this.loadAuthenticationUseCase=c}load(){this.loadAuthenticationUseCase.execute().pipe(a(1)).subscribe(t=>this.setState({auth:t}))}sendUserCode(e){this.setState({loading:!0}),this.sendUserCodeUseCase.execute(e).pipe(a(1)).subscribe(({message:i})=>{this.setState({sended:!0,loading:!1,message:i})})}validateUserCode(e){this.setState({loading:!0}),this.validateUserCodeUseCase.execute(e).pipe(a(1)).subscribe(()=>this.setState({loading:!1}))}createUser(e){this.setState({loading:!0});let t=this.createUserUseCase.execute(e);return t.pipe(a(1)).subscribe(),t}signOut(){this.setState(V),localStorage.removeItem("accessToken")}};function M(){return w(O,[h,v,$,f])}function G(r){return{"@context":"https://schema.org","@type":"Person",name:r.displayName,email:`mailto:${r.contact.email}`,url:`https://devparana.mx/#/sobre/${r.name}`}}var R=class extends z{findUsersUseCase;findUserByIDUseCase;updateProfileUseCase;updateUserUseCase;updatePhotoUseCase;updatePasswordUseCase;updateSocialUseCase;updateRolesUseCase;deleteUserUseCase;findUserByNameUseCase;profile$=this.select(e=>{if(e.selected){let{profile:t,id:i}=e.selected;return q(k({},t),{id:i})}return null});social$=this.selected$.pipe(n(e=>!!e),N(({id:e,social:t})=>({id:e,social:t})));schema$=this.selected$.pipe(n(e=>!!e),N(e=>G(e)));constructor(e,t,i,c,u,A,_,ee,te,re){super({response:{data:[],items:0,pages:0},params:{page:0,size:10,filter:{name:""}},selected:null}),this.findUsersUseCase=e,this.findUserByIDUseCase=t,this.updateProfileUseCase=i,this.updateUserUseCase=c,this.updatePhotoUseCase=u,this.updatePasswordUseCase=A,this.updateSocialUseCase=_,this.updateRolesUseCase=ee,this.deleteUserUseCase=te,this.findUserByNameUseCase=re}load(){this.onLoad(this.findUsersUseCase.execute(this.state.params))}loadOne(e){this.onLoadOne(this.findUserByIDUseCase.execute(e))}loadOneByName(e){this.onLoadOne(this.findUserByNameUseCase.execute(e))}update(e){this.updateUserUseCase.execute(e).pipe(a(1)).subscribe()}updateProfile(e){this.updateProfileUseCase.execute(e).pipe(a(1)).subscribe()}updatePhoto(e){this.updatePhotoUseCase.execute(e).pipe(a(1)).subscribe()}updatePassword(e){this.onUpdate(this.updatePasswordUseCase.execute(e))}updateSocial(e){this.updateSocialUseCase.execute(e).pipe(a(1)).subscribe()}updateRoles(e){this.onUpdate(this.updateRolesUseCase.execute(e))}delete(e){this.onDelete(this.deleteUserUseCase.execute(e))}};function J(){return w(R,[m,U,g,y,S,C,b,P,l,x])}function K(){return[M(),J()]}var D=class{http;env;endpoint;get url(){return`${this.env.api.url}/${this.endpoint}`}constructor(e,t,i){this.http=e,this.env=t,this.endpoint=i}load(){return this.http.get(this.url)}createUser(e){let t=[this.url,"create-user"];return this.http.post(t.join("/"),e)}sendUserCode(e){return this.http.post(this.url,{name:e})}validateUserCode(e){let t=[this.url,"validate"];return this.http.post(t.join("/"),e)}};function Q(){return{provide:p,useFactory(r,e){return new D(r,e,"authentication")},deps:[F,B]}}var j=class extends W{findOneByName(e){let t=[this.url,"about",e];return this.http.get(t.join("/"))}updatePassword(e){let t=[this.url,e.id,"password"];return this.http.patch(t.join("/"),e)}updateProfile(e){let t=[this.url,e.id,"profile"];return this.http.patch(t.join("/"),e)}updatePhoto(i){var c=i,{id:e}=c,t=I(c,["id"]);let u=new FormData;u.append("photo",t.photo),u.append("gender",t.gender??""),u.append("minibio",t.minibio??""),u.append("birthday",t.birthday?.toString()??"");let A=[this.url,e,"photo"];return this.http.post(A.join("/"),u)}updateSocial(e){let t=[this.url,e.id,"social"];return this.http.patch(t.join("/"),e)}updateRoles(e){let t=[this.url,e.id,"roles"];return this.http.patch(t.join("/"),e)}};function X(){return{provide:o,useFactory(r,e){return new j(r,e,"users")},deps:[F,B]}}function Y(){return[Q(),X()]}function se(){return s(h,[p])}function oe(){return s(l,[o])}function ie(){return s(U,[o])}function ae(){return s(x,[o])}function ne(){return s(m,[o])}function pe(){return s(f,[p])}function ue(){return s(v,[p])}function ce(){return s(C,[o])}function de(){return s(g,[o])}function he(){return s(y,[o])}function le(){return s(S,[o])}function Ue(){return s(b,[o])}function xe(){return s(P,[o])}function me(){return s($,[p])}function Z(){return[se(),oe(),ie(),ae(),ne(),pe(),ue(),ce(),le(),de(),he(),Ue(),xe(),me()]}function Mt(){return[...Y(),...Z(),...K()]}var Kt=(r,e)=>(r.loadOneByName(e.name),r.selected$.pipe(d(),n(t=>!!t)));var Yt=(r,e)=>(r.loadOneByName(e.name),r.schema$.pipe(d(),n(t=>!!t)));var er=(r,e)=>(r.loadOne(e.id),r.selected$.pipe(d(),n(t=>!!t)));export{O as a,R as b,Mt as c,Kt as d,Yt as e,er as f};
