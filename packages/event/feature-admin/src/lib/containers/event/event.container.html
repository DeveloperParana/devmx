<form id="event" [formGroup]="form" (submit)="onSubmit()">
  <div>
    <mat-card class="event-card">
      <mat-card-content class="event-content">
        <section>
          <mat-form-field>
            <mat-label>Qual nome ou título do evento?</mat-label>
            <input
              matInput
              formControlName="title"
              placeholder="Ex.: 10º Meetup Maringá Agile"
              autofocus
            />
            <mat-error>Obrigatório</mat-error>
          </mat-form-field>

          <div>
            <mat-form-field>
              <mat-label>Formato</mat-label>
              <mat-select formControlName="format">
                @for (format of form.formats; track format.value) {
                <mat-option [value]="format.value">
                  {{format.viewValue}}</mat-option
                >
                }
              </mat-select>
              <mat-error>Obrigatório</mat-error>
            </mat-form-field>

            <mat-form-field class="event-field-date">
              <mat-label>Data</mat-label>
              <input
                matInput
                [matDatepicker]="picker"
                formControlName="date"
                (focus)="picker.open()"
                tabindex="-1"
                readonly
              />
              <mat-datepicker-toggle
                matIconSuffix
                [for]="picker"
              ></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
              <mat-error>Obrigatório</mat-error>
            </mat-form-field>

            <mat-form-field class="event-field-time">
              <mat-label>Hora</mat-label>
              <input matInput formControlName="time" devmxTime />
              <devmx-icon matIconSuffix name="alarm-clock-alert" />
              <mat-error>
                @if (form.controls.time?.hasError('invalidTime')) { Inválido }
                @else { Obrigatório }
              </mat-error>
            </mat-form-field>
          </div>

          <div>
            <mat-form-field>
              <mat-label>Endereço</mat-label>
              <input matInput formControlName="address" />
              <mat-error>Obrigatório</mat-error>
            </mat-form-field>
          </div>
        </section>
      </mat-card-content>
    </mat-card>

    <mat-card>
      <devmx-editor
        label="Descreva o evento"
        hint="Compatível com markdown do Github"
        formControlName="description"
      />
    </mat-card>

    <mat-card>
      <mat-card-content>
        <section>
          <div class="event-presentations">
            <h3 mat-subheader>Apresentações</h3>

            <mat-list>
              @for (presentation of form.presentations.controls; track
              presentation.value; let index = $index) {
              <mat-list-item>
                <span matListItemTitle>{{presentation.value.title}}</span>
                <button
                  type="button"
                  mat-icon-button
                  matListItemMeta
                  (click)="form.presentations.removeAt(index)"
                >
                  <devmx-icon name="trash" />
                </button>
              </mat-list-item>
              }
            </mat-list>

            <button
              type="button"
              mat-icon-button
              (click)="openSearchPresentations()"
            >
              <devmx-icon name="plus" />
            </button>
          </div>

          <h3 mat-subheader>Líderes</h3>

          <mat-list>
            @for (leader of form.leaders.controls; track leader.value; let index
            = $index) {
            <mat-list-item>
              <span matListItemTitle>{{leader.value.displayName}}</span>
              <button
                type="button"
                mat-icon-button
                matListItemMeta
                (click)="form.leaders.removeAt(index)"
              >
                <devmx-icon name="trash" />
              </button>
            </mat-list-item>
            }
          </mat-list>

          <button type="button" mat-icon-button (click)="openSearchLeaders()">
            <devmx-icon name="plus" />
          </button>
        </section>

        <section></section>
      </mat-card-content>

      <mat-card-actions align="end">
        <button mat-button>Salvar</button>
      </mat-card-actions>
    </mat-card>
  </div>

  <mat-card class="tips-card"> </mat-card>
</form>
