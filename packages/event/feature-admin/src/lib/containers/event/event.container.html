<form id="event" [formGroup]="form" (submit)="onSubmit()">
  <mat-card class="event-card">
    <mat-card-content class="event-content">
      <section>
        <mat-form-field>
          <mat-label>Título do evento</mat-label>
          <input matInput formControlName="title" autofocus />
          <mat-error>Obrigatório</mat-error>
        </mat-form-field>

        <mat-form-field>
          <mat-label>Descrição</mat-label>
          <textarea
            matInput
            formControlName="description"
            cdkAutosizeMinRows="5"
            cdkAutosizeMaxRows="10"
            cdkTextareaAutosize
          ></textarea>
        </mat-form-field>

        <div class="cover">
          <devmx-select-file (selectedChange)="onCoverFile($event)" />
          <h3>Imagem de capa</h3>
        </div>
      </section>

      <section>
        <div>
          <mat-form-field>
            <mat-label>Formato</mat-label>
            <mat-select formControlName="format">
              @for (format of form.formats; track format) {
              <mat-option [value]="format.value"
                >{{format.viewValue}}</mat-option
              >
              }
            </mat-select>
            <mat-error>Obrigatório</mat-error>
          </mat-form-field>
          <mat-form-field>
            <mat-label>Data</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="date" />
            <mat-datepicker-toggle
              matIconSuffix
              [for]="picker"
            ></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
          <mat-form-field>
            <mat-label>Hora</mat-label>
            <mat-select formControlName="time">
              @for (time of form.times; track time) {
              <mat-option [value]="time"> {{time}} </mat-option>
              }
            </mat-select>
            <mat-error>Obrigatório</mat-error>
          </mat-form-field>
        </div>

        <div>
          <mat-form-field>
            <mat-label>Endereço</mat-label>
            <input matInput formControlName="address" />
            <mat-error>Obrigatório</mat-error>
          </mat-form-field>
        </div>

        <div class="event-presentations">
          <h3 mat-subheader>Apresentações</h3>

          <mat-list>
            @for (presentation of form.presentations.controls; track
            presentation.value; let index = $index) {
            <mat-list-item>
              <span matListItemTitle>{{presentation.value.title}}</span>
              <button
                type="button"
                mat-icon-button
                matListItemMeta
                (click)="form.presentations.removeAt(index)"
              >
                <devmx-icon name="trash" />
              </button>
            </mat-list-item>
            }
          </mat-list>
        </div>
      </section>
    </mat-card-content>

    <mat-card-actions align="end">
      <button mat-flat-button [disabled]="form.invalid">Salvar</button>
    </mat-card-actions>
  </mat-card>

  <pre>{{ form.leaders.value | json }}</pre>
  <pre>{{ form.presentations.value | json }}</pre>
</form>
